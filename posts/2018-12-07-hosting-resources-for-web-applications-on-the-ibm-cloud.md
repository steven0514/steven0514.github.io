---
id: 3180
title: 'Hosting Resources for Web Applications on the IBM Cloud'
date: '2018-12-07T09:47:33+00:00'
author: 'Niklas Heidloff'
layout: post
guid: 'http://heidloff.net/?p=3180'
permalink: /article/hosting-static-web-resources-ibm-cloud/
accesspresslite_sidebar_layout:
    - right-sidebar
dsq_thread_id:
    - '7092019143'
custom_permalink:
    - article/hosting-static-web-resources-ibm-cloud/
categories:
    - Articles
---

Recently I open sourced a complete [serverless web application](https://github.com/nheidloff/serverless-web-application-ibm-cloud) which can be deployed on the IBM Cloud. This short article describes how static web resources like HTML and JavaScript files can be hosted in the cloud in a serverless fashion.

This diagram shows the architecture of the full application. In this article I focus on the components in the red rectangle:

![image](/assets/img/2018/12/index-html-serverless.png)

[IBM Cloud Object Storage](https://console.bluemix.net/catalog/services/cloud-object-storage) allows storing files in the cloud and accessing them anonymously over [HTTP](https://console.bluemix.net/docs/services/cloud-object-storage/iam/public-access.html#allowing-public-access). For my Angular sample application I’ve created a [script](https://github.com/nheidloff/serverless-web-application-ibm-cloud/blob/master/scripts/setup-object-storage.sh#L71) that creates an object storage instance, creates a bucket and uploads the files generated by ‘ng build’.

After this the files can be accessed via URLs like this one: ‘https://s3.us-south.objectstorage.softlayer.net/serverless-web-unique-name/main.bundle.js’.

This works well for all resource types, except for the single page application’s entry point ‘index.html’. Unfortunately Object Storage doesn’t allow yet to use parameters in URLs which are often used in web applications.

Because of this my sample loads all resources from Object Storage except of the ‘index.html’ file. In order to host that file in the cloud I use I[BM Cloud Functions](https://console.ng.bluemix.net/openwhisk).

![image](/assets/img/2018/12/index-html-browser.png)

This is the code of the function which contains the text from index.html. Note that you have to replace the paths to your resources with the base URL of your Object Storage bucket. I’ve created another script to do this.

```
function main() {     
    return { body: `
    
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>OpenwhiskAngular</title>
  <script>document.write('<base href="' + document.location + '" />');</script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
  <app-root></app-root>
<script type="text/javascript" src="xxx-replace-me-xxx/inline.bundle.js"></script><script type="text/javascript" src="xxx-replace-me-xxx/polyfills.bundle.js"></script><script type="text/javascript" src="xxx-replace-me-xxx/styles.bundle.js"></script><script type="text/javascript" src="xxx-replace-me-xxx/vendor.bundle.js"></script><script type="text/javascript" src="xxx-replace-me-xxx/main.bundle.js"></script></body>
</html>    
    
    `}
  }
```

In order to expose this function, I’ve created an API via [IBM Cloud Functions API Management](https://console.bluemix.net/openwhisk/apimanagement). After this the ‘index.html’ file can be retrieved via URLs like this one: ‘https://service.us.apiconnect.ibmcloud.com/gws/apigateway/api/xxx/serverless/html’.

This works functionally, but the long URL is often not what you want to use in production environments. Fortunately it’s possible to use custom domains for OpenWhisk APIs. Check out the [documentation](https://console.bluemix.net/docs/api-management/manage_apis.html#custom_domains) and the blog from [James Thomas](http://jamesthom.as/blog/2018/12/03/custom-domains-with-ibm-cloud-functions/) for details.

In summary you need to upload your SSL/TLS certificates in a [Certification Manager](https://console.bluemix.net/catalog/services/certificate-manager) instance since HTTP traffic is not supported with custom domains. After this you can define to use your custom domain for a specific space in a specific location.

![image](/assets/img/2018/12/index-html-custom-domain.png)

If you want to try this functionality yourself, create an [IBM Cloud lite account](https://ibm.biz/nheidloff) (free, no credit card required) and follow the steps outlined in my [repo](https://github.com/nheidloff/serverless-web-application-ibm-cloud).

This article is part of a mini series. Check out the other articles and documentation:

- [Developing Serverless Web Applications on the IBM Cloud]({{ "/article/serverless-web-applications-ibm" | relative_url }})
- [Authentication of Users in Serverless Applications]({{ "/article/user-authentication-serverless-openwhisk" | relative_url }})
- [User Authorization in Serverless Web Applications]({{ "/article/user-authorization-serverless-web-applications-openwhisk" | relative_url }})
- [Setup Instructions](https://github.com/nheidloff/serverless-web-application-ibm-cloud/blob/master/README.md)
- [Screenshots](https://github.com/nheidloff/serverless-web-application-ibm-cloud/blob/master/documentation/serverless-web-apps.pdf)

</body></html>